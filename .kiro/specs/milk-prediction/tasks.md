# 実装計画

- [x] 1. Firebase Function用の型定義とインターフェースを作成
  - 予測リクエスト・レスポンスの型定義を作成
  - BabyEventの型定義を統一
  - 予測データの型定義を作成
  - _要件: 4.1, 4.3_

- [x] 2. 予測アルゴリズムのコア関数を実装
  - 授乳間隔計算関数を作成（外れ値除外ロジック含む）
  - 量抽出・平均計算関数を作成
  - 信頼度計算関数を作成
  - 各関数の単体テストを作成
  - _要件: 4.1, 4.4_

- [x] 3. Firestoreクエリ関数を実装
  - 過去7日間の授乳データ取得関数を作成
  - ミルクと母乳の両方を対象とするクエリを実装
  - タイムスタンプでの適切なソート・フィルタリングを実装
  - クエリ関数のテストを作成
  - _要件: 4.2, 4.3_

- [ ] 4. predictMilkFunction Firebase Functionを実装
  - 認証チェック機能を実装
  - Firestoreからのデータ取得処理を統合
  - 予測アルゴリズムを統合して次回時刻・量を計算
  - エラーハンドリングとログ出力を実装
  - _要件: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.4_

- [ ] 5. Firebase Functionの統合テストを作成
  - 正常ケースのテスト（十分なデータがある場合）
  - データ不足ケースのテスト
  - 認証エラーケースのテスト
  - 異常データ処理のテスト
  - _要件: 1.3, 3.4, 5.3_

- [x] 6. usePredictMilkフックの型定義を更新
  - 既存のPredictMilkData型を設計書に合わせて更新
  - レスポンス処理ロジックを新しい型に対応
  - エラーハンドリングを改善
  - _要件: 1.1, 1.4, 3.1, 3.3_

- [x] 7. フロントエンド予測表示コンポーネントを実装
  - 予測時刻の表示機能（日本語フォーマット）
  - 予測量の表示機能（範囲表示対応）
  - 信頼度とデータ範囲の表示
  - ローディング・エラー状態の表示
  - _要件: 1.1, 2.1, 2.3, 3.3, 5.1, 5.2_

- [x] 8. 予測時刻の強調表示機能を実装
  - 30分以内の予測時刻を強調表示するロジック
  - 視覚的な強調スタイルを実装
  - 時刻更新の自動チェック機能
  - _要件: 3.2_

- [x] 9. 自動更新機能を実装
  - 新しい授乳データ追加時の予測再計算
  - 予測時刻経過時の自動再計算
  - 適切な更新間隔の設定
  - _要件: 1.4, 3.1_

- [ ] 10. エンドツーエンドテストを作成
  - フロントエンドからFirebase Functionまでの完全フロー
  - 実際のFirestoreデータを使用した統合テスト
  - 各種エラーケースの動作確認
  - _要件: 1.3, 3.4, 5.3_

- [x] 11. Firebase Functionをindex.tsに登録
  - predictMilkFunctionをexportに追加
  - 既存の関数との整合性を確認
  - デプロイ設定の確認
  - _要件: 4.1_

- [x] 12. 予測機能をダッシュボードに統合
  - 既存のダッシュボードレイアウトに予測コンポーネントを配置
  - 他のBabyEventCardとの一貫性を保つスタイリング
  - レスポンシブデザインの確認
  - _要件: 1.1, 5.1_